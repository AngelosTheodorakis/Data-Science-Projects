
---
title: "Γραφήματα για Έρευνα ΠΜΣ"
author: "Angelos Theodorakis"
date: "16/4/2020"
output: 
      md_document:
        variant: markdown_github

---






```{r,echo=FALSE}
library(foreign)
library(knitr)
library(ggplot2)
library(scales)
library(dplyr)
source("http://peterhaschke.com/Code/multiplot.R")
```


```{r,echo=FALSE}
data <- read.spss("C:/Users/User/Desktop/Άγγελος/ΕΛΚΕ/Έρευνα/sodanet/My-encoding.sav",use.value.labels = FALSE, to.data.frame=TRUE)

#or file.choose()
```




# ΔΙΑΓΡΑΜΜΑΤΑ



```{r,echo=FALSE}

p1<-ggplot(data, aes(x = factor(Q1))) +  
  geom_bar(aes(y = (..count..)/sum(..count..), fill = factor(Q1))) + 
  geom_text(aes( label = scales::percent((..count..)/sum(..count..)),
                 y=(..count..)/sum(..count..) ), stat= "count", vjust = -.3) +
  scale_y_continuous(labels = percent) +
  labs(title='Ποσοστό Φύλων αποφοίτων ΠΜΣ', x='Φύλο',y='Ποσοστό')+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_x_discrete(labels=c('Γυναίκες','Άνδρες'))+
  scale_fill_discrete(name = "Φύλο", 
                       labels=c("Γυναίκες", "Άνδρες"))


p2<-ggplot(data, aes(x = factor(Age))) +  
  geom_bar(aes(y = (..count..)/sum(..count..), fill = factor(Age))) + 
  geom_text(aes( label = scales::percent((..count..)/sum(..count..)),
                 y=(..count..)/sum(..count..) ), stat= "count", vjust = -.3) +
  scale_y_continuous(labels = percent) +
  labs(title='Ποσοστό Ηλικίας αποφοίτων ΠΜΣ', x='Ηλικία',y='Ποσοστό')+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_x_discrete(labels=c('25-29','30-34','35-39','40+'))+
  scale_fill_discrete(name = "Ηλικία", 
                      labels=c('25-29','30-34','35-39','40+'))

ggplot(data, aes(x = factor(Gradyear))) +  
  geom_bar(aes(y = (..count..)/sum(..count..), fill = factor(Gradyear))) + 
  geom_text(aes( label = scales::percent((..count..)/sum(..count..)),
                 y=(..count..)/sum(..count..) ), stat= "count", vjust = -.3) +
  scale_y_continuous(labels = percent) +
  labs(title='Ποσοστό Έτών Αποφοίτησης', x='Έτος αποφοίτησης',y='Ποσοστό')+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_x_discrete(labels=c('1997-2002','2003-2007','2008-2012','2013-2017'))+
  scale_fill_discrete(name = "Φύλο", 
                      labels=c('1997-2002','2003-2007','2008-2012','2013-2017'))

multiplot(p1, p2, cols=2)
```


## Γραφήματα που αφορούν την επιλογή των απόφοιτων για τη σύσταση του μεταπτυχιακού σε τρίτους
```{r}

ggplot(data, aes(x = factor(Q13))) +  
  geom_bar(aes(y = (..count..)/sum(..count..), fill = factor(Q13))) + 
  geom_text(aes( label = scales::percent((..count..)/sum(..count..)),
                 y=(..count..)/sum(..count..) ), stat= "count", vjust = -.3) +
  scale_y_continuous(labels = percent) + 
  labs(title='Θα συστήνατε το μεταπτυχιακό;', x='Απάντηση',y='Πλήθος',
       fill='Θα συστήνατε 
το μεταπτυχιακό?')+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_x_discrete(labels=c('Σίγουρα ναι','Μάλλον ναι','Ούτε ναι ούτε όχι','Μάλλον όχι','Σίγουρα όχι'))+
scale_fill_discrete(labels=c('Σίγουρα ναι','Μάλλον ναι','Ούτε ναι ούτε όχι','Μάλλον όχι','Σίγουρα όχι'))

```


```{r,fig.width=12,fig.height=8,echo=FALSE}
data$Q3Factor <- factor(data$Q3, labels = c("Πολιτική Επιστήμη και Κοινωνιολογία", "Διεθνείς και Ευρωπαϊκές σπουδές", "Κράτος και Δημόσια Πολιτική", "Σπουδές Νοτιοανατολικής Ευρώπης"))


ggplot(data, aes(x = factor(Q13),fill=factor(Q13))) +  
  geom_bar(width=0.5) + 
  labs(title='Θα συστήνατε το μεταπτυχιακό;
(Διαχωρισμός ανα τμήμα)',
       x='Απάντηση',y='Πλήθος')+
  facet_wrap(~factor(Q3Factor))+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_x_discrete(labels=c('Σίγουρα ναι','Μάλλον ναι','Ούτε ναι ούτε όχι','Μάλλον όχι','Σίγουρα όχι'))+
  scale_fill_discrete(name='Απάντηση',labels=c('Σίγουρα ναι','Μάλλον ναι','Ούτε ναι ούτε όχι','Μάλλον όχι','Σίγουρα όχι'))

ggplot(data, aes(x = factor(Q13),fill=factor(Q1))) +  
  geom_bar(width=0.5) + 
  labs(title='Θα συστήνατε το μεταπτυχιακό;
(Διαχωρισμός ανα τμήμα και φύλο)',
       x='Απάντηση',y='Πλήθος')+
  facet_wrap(~factor(Q3Factor))+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_x_discrete(labels=c('Σίγουρα ναι','Μάλλον ναι','Ούτε ναι ούτε όχι','Μάλλον όχι','Σίγουρα όχι'))+
  scale_fill_discrete(name='Φύλο',labels=c('Γυναίκες','Άνδρες'))
```

### Το επόμενο διάγραμμα μας δείχνει την απάντηση για τη σύσταση ΠΜΣ σε τρίτους, ανα βαθμό ικανοποίησης από τις σπουδές των αποφοίτων.Υπάρχει όπως φαίνεται μια σύνδεση ανάμεσα στις 2 μεταβλητές.
```{r,fig.width=12,fig.height=7,echo=FALSE}
ggplot(data, aes(x = factor(Q13),fill=factor(Q13))) +  
  geom_bar(width=0.5) + 
  labs(title='Πρόταση ΠΜΣ
(Διαχωρισμός ανα Βαθμό Ικανοποίησης από τις σπουδές)',
       x='Απάντηση',y='Πλήθος')+
  facet_wrap(~factor(Q5_SQ001))+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_fill_discrete(name="Θα συστήνατε 
το ΠΜΣ;",
                      labels=c('Σίγουρα ναι','Μάλλον ναι','Ούτε ναι ούτε όχι','Μάλλον όχι','Σίγουρα όχι'))
```

### Στο επόμενο γράφημα παρατηρούμε την απάντηση για σύσταση του ΠΜΣ σε τρίτους ανά φύλο
```{r,fig.width=12,fig.height=7,echo=FALSE}

  data$AgeFactor <- factor(data$Age, labels = c('25-29','30-34','35-39','40+'))
  ggplot(data, aes(x = factor(Q13),fill=factor(Q1))) +  
    geom_bar(width=0.5) + 
    labs(title='Γνώμη για σύσταση ΠΜΣ ανά Ηλικίακή ομάδα', x='Γνώμη',y='Πλήθος')+
    facet_wrap(~factor(AgeFactor))+
    theme(plot.title = element_text(hjust = 0.5))+
    scale_x_discrete(labels = c("Σίγουρα ναι", "Μάλλον ναι", "Ούτε ναι ούτε οχι", "Μάλλον όχι", "Σίγουρα όχι"))+
    scale_fill_discrete(name = "Φύλο", 
                        labels=c("Γυναίκες", "Άνδρες"))
  
```

### Στο παρακάτω γράφημα παρατηρούμε το πως η ικανοποίηση από την τρέχουσα απασχόληση επηρεάζει την απάντηση για σύσταση του ΠΜΣ σε τρίτους
```{r,fig.width=12,fig.height=7,echo=FALSE}
  data$Q7Factor <- factor(data$Q7, labels = c("Πολύ ευχαριστημένος", "Αρκετά ευχαριστημένος", "Ούτε ευχαριστημένος ούτε δυσαρεστημένος", "Αρκετά δυσαρεστημένος ", "Πολύ δυσαρεστημένος"))
  ggplot(data, aes(x = factor(Q13),fill=factor(Q13))) +  
    geom_bar(width=0.5) + 
    facet_wrap(~factor(Q7Factor))+
  scale_fill_discrete(name = "Θα συστήνατε
το μεταπτυχιακό;",labels = c("Σίγουρα ναι", "Μάλλον ναι", "Ούτε ναι ούτε οχι", "Μάλλον όχι", "Σίγουρα όχι"))+
    labs(title='Σύσταση ΠΜΣ ανα ικανοποίηση από τρέχουσα απασχόληση', x='Θα συστήνατε το ΠΜΣ;',y='Πλήθος',
         fill='Συνάφεια με εργασία')+
    theme(plot.title = element_text(hjust = 0.5))

```



```{r,echo=FALSE}
data$work <- rep('Άνεργοι',nrow(data))
data[(data$Q6<=15) & (!is.na(data$Q6)),'work'] <- 'Εργαζόμενοι'
data[is.na(data$Q6),'work'] <- NA
```

### Στο παρακάτω γράφημα ελέγχουμε αν η εργασιακή κατάσταση επηρεάζει την απόφαση για την σύσταση του ΠΜΣ σε τρίτους 
```{r,fig.width=14,fig.height=7,echo=FALSE}
ggplot(data, aes(x = factor(Q13),fill = factor(Q13))) +  
  geom_bar(aes(y = (..count..)/sum(..count..))) + 
  scale_y_continuous(labels = percent)+
  labs(title='Συνάφεια ΠΜΣ με εργασιακή κατάσταση και σύσταση ΠΜΣ', x='Θα προτείνατε το ΠΜΣ;',y='Συνολικό Ποσοστό',
       fill='Απάντηση')+
  theme(plot.title = element_text(hjust = 0.5))+
  facet_wrap(~factor(work))+
  scale_fill_discrete( labels = c('Σίγουρα ναι','Μάλλον ναι','Ούτε ναι ούτε όχι','Μάλλον όχι','Σίγουρα όχι',"NA"))

```


### Στο παρακάτω γράφημα παρατηρούμε τον αριθμό των αποφοίτων σε κάθε τμήμα , ανα ηλικιακή ομάδα και φύλο. Οι γυναίκες υπερισχύουν στο τμήμα Κράτος και Δημόσια Πολιτική ,σε κάθε ηλικιακή ομάδα
```{r,fig.width=12,fig.height=7,echo=FALSE}
ggplot(data, aes(x = factor(Q3Factor),fill=factor(Q1))) +  
  geom_bar(width=0.5) + 
  labs(title='Τμήμα ΠΜΣ ανά Ηλικίακή ομάδα και φύλο', x='Τμήμα',y='Πλήθος')+
  facet_wrap(~factor(AgeFactor))+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_x_discrete(labels = c("Πολ.Επ.", "Διεθ.Σπ.", "Κρ.Δημ.Πολ.", "Σπ.Νοτ.Ευρ."))+
  scale_fill_discrete(name = "Φύλο", 
                      labels=c("Γυναίκες", "Άνδρες"))
```

### Το ίδιο γράφημα, αυτή τη φορά ανα ηλικιακή ομάδα και εργασιακή κατάσταση.
```{r,fig.width=12,fig.height=7,echo=FALSE}
ggplot(data, aes(x = factor(Q3Factor),fill=factor(work))) +  
  geom_bar(width=0.5) + 
  labs(title='Τμήμα ΠΜΣ ανά Ηλικίακή ομάδα και εργασιακή κατάσταση', x='Τμήμα',y='Πλήθος')+
  facet_wrap(~factor(AgeFactor))+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_x_discrete(labels = c("Πολ.Επ.", "Διεθ.Σπ.", "Κρ.Δημ.Πολ.", "Σπ.Νοτ.Ευρ."))+
  scale_fill_discrete(name = "Κατάσταση")
```

### Στο παρακάτω γράφημα παρατηρούμε οτι το Τμήμα Πολιτικής Επιστήμης έχει συγκριτικά με τα υπόλοιπα τμήματα μεγαλύτερη συμβολή στην εύρεση εργασίας
```{r,fig.width=12,fig.height=7,echo=FALSE}

ggplot(data, aes(x = factor(Q9_SQ002),fill=factor(work))) +  
  geom_bar(width=0.5) + 
  labs(title='Συμβολή στην εύρεση εργασίας ανα Τμήμα ΠΜΣ και εργασιακή κατάσταση', x='Τμήμα',y='Πλήθος')+
  facet_wrap(~factor(Q3Factor))+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_x_discrete(labels = c("NA","Πολύ", "Αρκετά", "Ούτε πολύ ούτε λίγο", "Λίγο","Καθόλου"))+
  scale_fill_discrete(name = "Κατάσταση")

```


### Στο παρακάτω γράφημα μπορούμε να παρατηρήσουμε αν η σχέση του ΠΜΣ με την απασχόληση των αποφοίτων, επηρεάζει την απόφασή τους για τη σύσταση του ΠΜΣ
```{r,echo=FALSE}
ggplot(data, aes(x = factor(Q13),fill = factor(Q8))) +  
  geom_bar(aes(y = (..count..)/sum(..count..))) + 
  scale_y_continuous(labels = percent)+
  labs(title='Σχέση ΠΜΣ με τωρινή/πρόσφατη εργασία και σύσταση ΠΜΣ', x='Θα προτείνατε το ΠΜΣ;',y='Ποσοστό',
       fill='Σχέση ΠΜΣ
με εργασία')+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_x_discrete(labels=c('Σίγουρα ναι','Μάλλον ναι','Ούτε ναι ούτε όχι','Μάλλον όχι','Σίγουρα όχι'))+
scale_fill_discrete(
  labels = c("Πολύ σχετικό ", "Αρκετά σχετικό", "Όχι και τόσο ", "Καθόλου σχετικό ", "Δεν έχω εργαστεί",'NA'))
```









